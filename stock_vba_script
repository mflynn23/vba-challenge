Sub Multi_Year_Stock_Data():
    
    Dim ws As Worksheet
    
    
    For Each ws In Worksheets
        ws.Select
        
    Next ws

End Sub

Sub Stock_Challenge():


Dim rowcount As Double
rowcount = Cells(Rows.Count, "A").End(xlUp).Row


[I1] = "Ticker"
[J1] = "Yearly Change"
[K1] = "Percent Change"
[L1] = "Total Stock Volume"
[O1] = "Ticker"
[P1] = "Value"
[N2] = "Greatest % Inc"
[N3] = "Greatest % Dec"
[N4] = "Greatest Total Vol"


Columns("A:P").AutoFit


Cells(2, 9).Value = Cells(2, 1).Value


tickerrow = 2


Dim openprice, closeprice, yearlychange As Double


openprice = [C2]


Dim percentchange As Double


Dim totalstockvalue As LongLong
totalstockvalue = 0


For i = 2 To (rowcount)

    
    totalstockvalue = totalstockvalue + Cells(i, 7).Value
    
   
    If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then
    
    
    Cells(tickerrow, 12) = totalstockvalue
    
    
    totalstockvalue = 0
    
    
    Dim ticker As String
    ticker = Cells(i, 1).Value
    
    
    Range("I" & tickerrow).Value = ticker
    
    
    closeprice = Cells(i, 6).Value
    
    
    yearlychange = closeprice - openprice
    Cells(tickerrow, 10).Value = yearlychange
    
    
    If openprice = 0 Then
    Cells(tickerrow, 11).Value = "NA"
    
    Else
    percentchange = (closeprice - openprice) / openprice
    Cells(tickerrow, 11).Value = percentchange
    
    End If
    
    
    openprice = Cells(i + 1, 3).Value
    
     
    tickerrow = tickerrow + 1
    
    
    Else
    
    End If
    
Next i

Dim tablerowcount As Integer
tablerowcount = Cells(Rows.Count, "I").End(xlUp).Row

Range("K2:K" & tablerowcount).NumberFormat = "0.00%"

Range("L2:L" & tablerowcount).NumberFormat = "###,###,###,##0"

For j = 1 To tablerowcount
    If Cells(j, 10).Value < 0 Then
    Cells(j, 10).Interior.ColorIndex = 3
    Else: Cells(j, 10).Interior.ColorIndex = 4
    End If
Next j


Dim maxpercent As Double
Dim maxticker As String

maxpercent = 0.001

For k = 2 To tablerowcount
    If (Cells(k, 11).Value <> "NA") Then
        If (Cells(k, 11).Value > maxpercent) Then
            maxpercent = Cells(k, 11).Value
            maxticker = Cells(k, 9).Value
        End If
    ElseIf (Cells(k, 11).Value = "NA") Then
    End If
Next k

[O2] = maxticker
[P2] = maxpercent

Dim minpercent As Double
Dim minticker As String

minpercent = 0

For m = 2 To tablerowcount
    If (Cells(m, 11).Value < minpercent) Then
        minpercent = Cells(m, 11).Value
        minticker = Cells(m, 9).Value
    End If
Next m

[O3] = minticker
[P3] = minpercent

Dim maxvolume As LongLong
Dim maxvolticker As String

maxvolume = 1

For n = 2 To tablerowcount
    If (Cells(n, 12).Value > maxvolume) Then
        maxvolume = Cells(n, 12).Value
        maxvolticker = Cells(n, 9).Value
    End If
Next n

[O4] = maxvolticker
[P4] = maxvolume

Range("P2:P3").NumberFormat = "0.00%"
Range("P4").NumberFormat = "###,###,###,#00"

End Sub
